{% extends "template.html" %}

{% block head %}
  {{ super() }} <!-- Keep parent template's head content -->
  <title>Add Listings</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Add only component-specific styles here */
    .listings-dashboard {
      flex: 1;
      background-color: white;
      border-radius: 8px;
      padding: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      overflow-y: auto;
    }

    .dark-mode .listings-dashboard {
      background-color: #1f2a48; /* Dark blue background for dark mode */
      color: #ffffff;
    }

    .listing {
      background-color: white;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      cursor: pointer;
      transition: box-shadow 0.2s ease, border-color 0.2s ease;
    }

    .dark-mode .listing {
      background-color: #0a192f; /* Dark blue background for dark mode */
      border-color: #333;
      color: #ffffff;
    }

    .listing:hover {
      border-color: #007bff;
      box-shadow: 0 4px 8px rgba(0, 123, 255, 0.1);
    }

    .dark-mode .listing:hover {
      border-color: #64b5f6; /* Light blue border for dark mode */
      box-shadow: 0 4px 8px rgba(100, 181, 246, 0.1);
    }

    .fab {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: background-color 0.2s ease, transform 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dark-mode .fab {
      background-color: #64b5f6; /* Light blue for dark mode */
    }

    .fab:hover {
      background-color: #005bb5;
      transform: scale(1.1);
    }

    .dark-mode .fab:hover {
      background-color: #42a5f5; /* Slightly lighter blue for dark mode */
    }

    .modal-content {
      background-color: white;
      border-radius: 8px;
      padding: 2rem;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      animation: slideIn 0.3s ease;
    }

    .dark-mode .modal-content {
      background-color: #1f2a48; /* Dark blue background for dark mode */
      color: #ffffff;
    }

    .toast {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background-color: #333;
      color: white;
      padding: 1rem;
      border-radius: 5px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      animation: slideIn 0.3s ease;
      z-index: 1000;
    }

    .dark-mode .toast {
      background-color: #1f2a48; /* Dark blue background for dark mode */
      color: #ffffff;
    }

    @keyframes slideIn {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    /* Form Styles */
    .form-control {
      background-color: white;
      color: #1d1d1f;
      border: 1px solid #e0e0e0;
    }

    .dark-mode .form-control {
      background-color: #0a192f; /* Dark blue background for dark mode */
      color: #ffffff;
      border-color: #333;
    }

    .form-control:focus {
      border-color: #007bff;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
    }

    .dark-mode .form-control:focus {
      border-color: #64b5f6; /* Light blue border for dark mode */
      box-shadow: 0 0 0 3px rgba(100, 181, 246, 0.1);
    }

    .btn-success {
      background-color: #28a745;
      border-color: #28a745;
    }

    .dark-mode .btn-success {
      background-color: #218838; /* Slightly darker green for dark mode */
      border-color: #218838;
    }

    .btn-success:hover {
      background-color: #218838;
      border-color: #1e7e34;
    }

    .dark-mode .btn-success:hover {
      background-color: #1e7e34; /* Even darker green for dark mode */
      border-color: #1e7e34;
    }
  </style>
{% endblock %}

{% block body %}
  <!-- Main Content -->
  <div class="listings-dashboard">
    <h2>Your Listings</h2>
    <div id="listings-container">
      <!-- Existing listings will be displayed here -->
    </div>
  </div>

  <!-- Floating Action Button -->
  <button class="fab" onclick="openModal()">
    <i class="fas fa-plus"></i>
  </button>

  <!-- Modal for Adding Listings -->
  <div class="modal" id="addListingModal">
    <div class="modal-content">
      <h3>Add New Job Listing</h3>
      <form action='/create_job_posting' method='POST'>
        <div class="mb-3">
          <label for="applicant_name" class="form-label">Company Name:</label>
          <input class="form-control" type="text" name="applicant_name" id="applicant_name" 
                 placeholder="Enter Your Company Name" required>
        </div>

        <div class="mb-3">
          <label for="position" class="form-label">Position Name:</label>
          <input class="form-control" type="text" name="position" id="position" 
                 placeholder="Enter Position Name" required>
        </div>

        <div class="mb-3">
          <label for="salary" class="form-label">Starting Salary:</label>
          <input class="form-control" type="text" name="salary" id="salary" 
                 placeholder="Enter Starting Salary" required>
        </div>

        <div class="mb-3">
          <label for="cover_letter" class="form-label">Other Information:</label>
          <textarea class="form-control" id="cover_letter" rows="3" name="cover_letter" 
                    placeholder="Enter Other Information Here"></textarea>
        </div>

        <div class="d-grid gap-2">
          <input type="submit" class="btn btn-success" value="Submit Posting Request">
        </div>
      </form>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast" style="display: none;"></div>

  <script>
    // Modal Functions
    function openModal() {
      document.getElementById('addListingModal').classList.add('open');
    }

    function closeModal() {
      document.getElementById('addListingModal').classList.remove('open');
    }

    // Toast Notification
    function showToast(message, type) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type}`;
      toast.style.display = 'block';
      setTimeout(() => {
        toast.style.display = 'none';
      }, 3000);
    }

    // Save Listing
    function saveListing() {
      const jobName = document.getElementById('jobName').value;
      const jobDescription = document.getElementById('jobDescription').value;
      const jobLocation = document.getElementById('jobLocation').value;
      const jobSalary = document.getElementById('jobSalary').value;
      const jobExperience = document.getElementById('jobExperience').value;

      if (!jobName || !jobDescription || !jobLocation || !jobSalary || !jobExperience) {
        showToast('Please fill out all fields.', 'error');
        return;
      }

      const listingsContainer = document.getElementById('listings-container');
      const newListing = document.createElement('div');
      newListing.className = 'listing';
      newListing.innerHTML = `
        <h3>${jobName}</h3>
        <p>${jobLocation} | ${jobSalary} | ${jobExperience.charAt(0).toUpperCase() + jobExperience.slice(1)} Level</p>
        <p>${jobDescription}</p>
        <button class="delete-button" onclick="this.parentElement.remove(); showToast('Listing deleted.', 'error')">Delete</button>
      `;
      listingsContainer.appendChild(newListing);

      closeModal();
      showToast('Listing saved successfully!', 'success');
    }
  </script>
{% endblock %}